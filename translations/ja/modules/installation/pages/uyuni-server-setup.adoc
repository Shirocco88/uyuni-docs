[[server-setup]]
= Uyuniサーバの設定

このセクションでは、{productname}サーバの設定について説明します。次のプロシージャを使用します。

* {yast}を使用して{productname}の設定を開始する
* {productname}の{webui}を使用してメイン管理者アカウントを作成する
* ベース組織に名前を付け、ログイン資格情報を追加する
* {scc}から{sle}製品チャンネルを同期する



[[server-setup-yast]]
== {yast}を使用して{productname}を設定する

このセクションでは、{productname}の設定プロシージャについて説明します。

.プロシージャ: {productname}の設定
. {productname}サーバにログインし、{yast}を開始します。

. {yast}で、menu:ネットワークサービス[Uyuni Setup（Uyuniの設定）]に移動し、設定を開始します。

. 導入画面から、menu:Uyuni Setup（Uyuniの設定）[Set up Uyuni from scratch（Uyuniを最初から設定する）]を選択し、［btn:[次へ]］をクリックして続行します。

. 状態通知を受け取るメールアドレスを入力し、［btn:[次へ]］をクリックして続行します。
    {productname}は、大容量の通知メールを送信する場合があります。 必要に応じて、設定後に{webui}のメール通知を無効にできます。

. 証明書情報およびパスワードを入力します。
    パスワードは7文字以上にし、スペース、一重引用符(``'``)、二重引用符(``"``)、感嘆符(``!``)、またはドル記号(``$``)は使用しないでください。 パスワードは必ず安全な場所に保管してください。
+

[IMPORTANT]
====
{productname}プロキシを設定するには、証明書のパスワードが必要です。
====

. ［btn:[次へ]］をクリックして続行します。
+


. menu:Uyuni Setup（Uyuniの設定）[データベースの設定]画面から、データベースユーザおよびパスワードを入力し、［btn:[次へ]］をクリックして続行します。
    パスワードは7文字以上にし、スペース、一重引用符(``'``)、二重引用符(``"``)、感嘆符(``!``)、またはドル記号(``$``)は使用しないでください。 パスワードは必ず安全な場所に保管してください。
+


. ［btn:[次へ]］をクリックして続行します。

. プロンプトが表示されたら［btn:[はい]］をクリックして設定を実行します。

. 設定が完了したら、［btn:[次へ]］をクリックして続行します。
    {productname}の{webui}のアドレスが表示されます。

. ［btn:[完了]］をクリックし、{productname}の設定を完了します。



== メイン管理アカウントの作成

このセクションでは、{productname}用の組織のメイン管理アカウントの作成方法について説明します。

[WARNING]
====
メイン管理アカウントには{productname}内で最高の権限があります。 このアカウントのアクセス情報は安全に保管してください。

組織およびグループ用に低レベルの管理アカウントを作成することをお勧めします。 メイン管理アクセスの詳細を共有しないでください。
====


.プロシージャ: メイン管理アカウントの設定

. 使用しているWebブラウザで、{productname}の{webui}のアドレスを入力します。
    このアドレスは、設定完了後に提供されます。 詳細については、xref:uyuni-server-setup.adoc#server-setup-yast[]を参照してください。

. {webui}にログインし、menu:組織の作成[組織名]フィールドに移動し、組織名を入力します。

. menu:組織の作成[希望のログイン]フィールドおよびmenu:組織の作成[希望のパスワード]フィールドにユーザ名とパスワードを入力します。

. システム通知用のメールなど、アカウント情報の各フィールドに記入します。

. ［btn:[組織の作成]］をクリックして、管理アカウントの作成を完了します。
+


{productname}の{webui}の設定を完了すると、menu:ホーム[概要]ページが表示されます。


== オプション: {scc}の製品の同期

{scc} (SCC)は、パッケージソフトウェアが含まれているリポジトリのコレクションを管理し、サポートされているすべてのエンタープライズクライアントシステムを更新します。 これらのリポジトリは複数のチャンネルに編成されます。各チャンネルは、ディストリビューション、リリース、およびアーキテクチャに固有のソフトウェアを提供します。 SCCと同期した後、クライアントは更新を受け取り、グループに編成され、特定の製品ソフトウェアチャンネルに割り当てられる場合があります。

このセクションでは、{webui}からSCCと同期を取り、最初のクライアントチャンネルを追加する方法について説明します。

[NOTE]
====
Uyuniでは、{scc}からの製品の同期はオプションです。
====

ソフトウェアリポジトリをSCCと同期する前に、{productname}に組織の資格情報を入力する必要があります。 組織の資格情報があると、{suse}製品のダウンロードにアクセスできます。 組織の資格情報はhttps://scc.suse.com/organizationsにあります。

{productname}の{webui}に組織の資格情報を入力します。


[[proc-admin-organization-credentials]]
.プロシージャ: 組織の資格情報の入力
. {susemgr}の{webui}で、menu:メインメニュー[管理 > セットアップウィザード]に移動します。
. ［[guimenu]``セットアップウィザード``］ページで、［btn:[組織の資格情報]］タブに移動します。
. ［btn:[Add a new credential（新しい資格情報の追加）]］をクリックします。
. ユーザ名およびパスワードを入力し、［btn:[保存]］をクリックします。

資格情報が確認されると、チェックマークアイコンが表示されます。 新しい資格情報を正しく入力すると、{scc}と同期できます。


[[proc-quickstart-first-channel-sync]]
.プロシージャ: {scc}との同期
. {productname}の{webui}で、menu:管理[セットアップウィザード]に移動します。

. ［[guimenu]``セットアップウィザード``］ページから、［btn:[SUSE製品]］タブを選択します。
    製品一覧が入力されるまで待機します。 以前{scc}で登録したことがある場合、製品の一覧が表に入力されます。 この表は、アーキテクチャ、チャンネル、状態の各情報を一覧表示します。 詳細については、xref:reference:admin/setup-wizard.adoc[ウィザード]を参照してください。
+

image::admin_suse_products.png[scaledwidth=80%]

. {sle}クライアントが[systemitem]``x86_64``アーキテクチャに基づいている場合、ページをスクロールして下に移動し、このチャンネルのチェックボックスを付けます。
+

* {productname}にチャンネルを追加します。そのためには、各チャンネルの左にあるチェックボックスにチェックを付けます。
    説明の左にある矢印をクリックして、製品を展開し、使用できるモジュールを一覧表示します。
* ［btn:[製品の追加]］をクリックして、製品の同期を開始します。

チャンネルを追加した後、{productname}は、チャンネルの同期をスケジュールします。 この処理には時間がかかる場合があります。その理由は、{scc}にある{suse}リポジトリからサーバのローカル[path]``/var/spacewalk/``ディレクトリにチャンネルソフトウェアソースを{productname}でコピーするためです。


[NOTE]
====
環境によっては、カーネルが提供する透過的なHuge Pageによって、PostgreSQLのワークロードが大幅に低速になる場合があります。

透過的なHuge Pageを無効にするには、[parameter]``transparent_hugepage``カーネルパラメータを``never``に設定します。 [path]``/etc/default/grub``ファイルを開き、行[option]``GRUB_CMDLINE_LINUX_DEFAULT``を追加または編集する必要もあります。 例:

----
GRUB_CMDLINE_LINUX_DEFAULT="resume=/dev/sda1 splash=silent quiet showopts elevator=noop transparent_hugepage=never"
----

新しい設定を書き込むには、[command]``grub2-mkconfig -o /boot/grub2/grub.cfg``を実行します。
====

チャンネル同期プロセスをリアルタイムでモニタします。そのためには、ディレクトリ[path]``/var/log/rhn/reposync``にあるチャンネルログファイルを表示します。

----
tail -f /var/log/rhn/reposync/<CHANNEL_NAME>.log
----

チャンネル同期プロセスが完了したら、クライアントの登録に進むことができます。 詳細手順については、xref:client-configuration:registration-overview.adoc[]を参照してください。
