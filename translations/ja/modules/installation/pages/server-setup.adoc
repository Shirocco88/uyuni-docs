[[server-setup]]
= SUSE Managerのサーバ設定

このセクションでは、{productname}サーバの設定について説明します。次のプロシージャを使用します。

* YaSTを使用して{productname}の設定を開始する
* {productname}の{webui}を使用してメイン管理者アカウントを作成する
* ベース組織に名前を付け、ログイン資格情報を追加する
* {scc}から{sle}製品チャンネルを同期する

[WARNING]
====
{productname}は、{sle}製品ファミリの一部であるため、{sles}に付属しているソフトウェアと互換性があります。

{productname}は複雑なシステムであるため、サードパーティソフトウェアのインストールは許可されていません。 サードパーティベンダが提供しているモニタリングソフトウェアをインストールすることは、SSL、暗号化ソフトウェアのようなツールなどの基本的なライブラリを交換しない場合のみ許可されます。 製品サポート提供の一環として、SUSEは、サードパーティソフトウェア(および関連する設定変更)を削除し、きれいになったシステムで問題を再現することを要求する権利を有しています。
====


[IMPORTANT]
====
{productname}サーバをこのサーバ自体に登録しないでください。 {productname}サーバは個別に管理するか、別の{productname}サーバを使用して管理する必要があります。 複数のサーバを使用する方法の詳細については、xref:large-deployments:multi-server.adoc[]を参照してください。
====



== YaSTを使用して{productname}を設定する

このセクションでは、{yast}を使用して{productname}の設定について説明します。



.プロシージャ: {productname}の設定
. {productname}サーバのコマンドプロンプトで、[command]``yast2 susemanager_setup``コマンドを使用して設定を開始します。
. 導入画面から、menu:SUSE Manager Setup（SUSE Managerの設定）[Setup SUSE Manager from scratch（SUSE Managerを最初から設定する）]を選択し、［btn:[次へ]］をクリックして続行します。
. 状態通知を受け取るメールアドレスを入力し、［btn:[次へ]］をクリックして続行します。
    {productname}は、大容量の通知メールを送信する場合があります。 必要に応じて、設定後に{webui}のメール通知を無効にできます。 メール通知を無効にする方法の詳細については、xref:reference:users/user-details.adoc[]を参照してください。
. 証明書情報およびパスワードを入力します。
    カスタムSSL証明書を使用する場合、まずこの設定を行う必要があります。 SSL証明書の詳細については、xref:administration:ssl-certs.adoc[]を参照してください。
+
image::quickstart-mgr-setup4-ncurses.png[scaledwidth=80%]
. ［btn:[次へ]］をクリックして続行します。
. menu:SUSE Manager Setup（SUSE Managerの設定）[データベースの設定]画面から、データベースのユーザとパスワードを入力し、［btn:[次へ]］をクリックして続行します。
+
image::quickstart-mgr-setup5-ncurses.png[scaledwidth=80%]
. ［btn:[次へ]］をクリックして続行します。
. ［btn:[はい]］をクリックしてプロンプトが表示されたら設定を実行し、完了するのを待機します。
. ［btn:[次へ]］をクリックして続行します。
    {productname}の{webui}のアドレスをメモします。
. ［btn:[完了]］をクリックし、{productname}の設定を完了します。

[IMPORTANT]
====
証明書パスワードの作成時、パスワードの長さは7文字以上にしてください。 スペース、一重引用符(``'``)、二重引用符(``"``)、感嘆符、(``!``)、ドル記号(``$``)は使用しないでください。 パスワードは必ず安全な場所に保管してください。 このパスワードがないと、{productname}プロキシを設定できません。
====


== メイン管理アカウントの作成

このセクションでは、{productname}用の組織のメイン管理アカウントの作成について説明します。

[WARNING]
====
メイン管理アカウントは、{productname}内で「最高の認可アカウント」であるため、アカウントのアクセス情報は安全な場所に保管する必要があります。

セキュリティの観点から、メイン管理者は、組織および個々のグループで管理専用の「低レベル管理アカウント」を作成することをお勧めします。
====


.プロシージャ: メイン管理アカウントの設定
. ブラウザで、設定完了後に提供されるアドレスを入力します。
    このアドレスを使用して、{productname}の{webui}を開きます。

. {webui}で、menu:組織の作成[組織名]フィールドに移動し、組織名を入力します。

. menu:組織の作成[希望のログイン]フィールドおよびmenu:組織の作成[希望のパスワード]フィールドにユーザ名とパスワードを入力します。

. システム通知用のメールなど、アカウント情報の各フィールドに記入します。

. ［btn:[組織の作成]］をクリックして、管理アカウントの作成を完了します。
+

image::quickstart-mgr-setup-admin1.png[scaledwidth=80%]

{productname}のmenu:ホーム[概要]ページに表示されるようになります。


== {scc}の製品の同期

{scc} (SCC)は、パッケージソフトウェアが含まれているリポジトリのコレクションを管理し、サポートされているすべてのエンタープライズクライアントシステムを更新します。 これらのリポジトリは複数のチャンネルに編成されます。各チャンネルは、ディストリビューション、リリース、およびアーキテクチャに固有のソフトウェアを提供します。 SCCと同期した後、クライアントは更新を受け取り、グループに編成され、特定の製品ソフトウェアチャンネルに割り当てられる場合があります。

このセクションでは、{webui}からSCCと同期を取り、最初のクライアントチャンネルを追加する方法について説明します。

ソフトウェアリポジトリをSCCと同期する前に、{susemgr}に組織の資格情報を入力する必要があります。 以前のバージョンでは、代わりにいわゆるミラー資格情報が使用されていました。 組織の資格情報があると、SUSE製品のダウンロードにアクセスできます。 組織の資格情報はhttps://scc.suse.com/organizationsにあります。

{susemgr}の{webui}に組織の資格情報を入力します。


[[proc-admin-organization-credentials]]
.プロシージャ: 組織の資格情報の入力
. {susemgr}の{webui}で、menu:管理[セットアップウィザード]を選択します。
. ［[guimenu]``セットアップウィザード``］ページから、［btn:[組織の資格情報]］タブを選択します。
. ［btn:[Add a new credential（新しい資格情報の追加）]］をクリックします。
. ダイアログで、［[guimenu]``ユーザ名``］および［[guimenu]``パスワード``］を入力し、［btn:[保存]］をクリックして確認します。

チェックマークアイコンで資格情報を確認したら、<<proc-quickstart-first-channel-sync>>に進みます。


[[proc-quickstart-first-channel-sync]]
.プロシージャ: {scc}との同期
. {webui}で、menu:管理[セットアップウィザード]に移動します。

. ［[guimenu]``セットアップウィザード``］ページから、［btn:[SUSE製品]］タブを選択します。
    以前{scc}で登録したことがある場合、製品の一覧が表に入力されます。 この操作には数分かかる場合があります。 右側の``SUSEカスタマーセンターから製品カタログを更新``セクションで、操作の進行状況を監視できます。 この表は、アーキテクチャ、チャンネル、状態の各情報を一覧表示します。 詳細については、xref:reference:admin/setup-wizard.adoc[ウィザード]を参照してください。
+

image::admin_suse_products.png[scaledwidth=80%]

. 表示されている製品のリストをフィルタするには、``製品説明でフィルタ``および``アーキテクチャでフィルタ``を使用します。
    {sle}クライアントが[systemitem]``x86_64``アーキテクチャに基づいている場合、ページをスクロールして下に移動し、このチャンネルのチェックボックスを付けます。
+

* {productname}にチャンネルを追加します。そのためには、各チャンネルの左にあるチェックボックスにチェックを付けます。
    説明の左にある矢印をクリックして、製品を展開し、使用できるモジュールを一覧表示します。
* ［btn:[製品の追加]］をクリックして、製品の同期を開始します。

チャンネルを追加した後、{productname}は、チャンネルの同期をスケジュールします。 この処理には時間がかかる場合があります。その理由は、{scc}にある{suse}リポジトリからサーバのローカル[path]``/var/spacewalk/``ディレクトリにチャンネルソフトウェアソースを{productname}でコピーするためです。


[TIP]
.PostgreSQLおよび透過的Huge Page
====
環境によっては、カーネルで提供する「透過的なHuge Page」によって、PostgreSQLのワークロードが大幅に低速になる場合があります。

「透過的なHuge Page」を無効にするには、[option]``transparent_hugepage``カーネルパラメータを[option]``never``に設定します。 これは、[path]``/etc/default/grub``で変更し、行[option]``GRUB_CMDLINE_LINUX_DEFAULT``に追加する必要があります。次に例を示します。

----
GRUB_CMDLINE_LINUX_DEFAULT="resume=/dev/sda1 splash=silent quiet showopts elevator=noop transparent_hugepage=never"
----

新しい設定を書き込むには、[command]``grub2-mkconfig -o /boot/grub2/grub.cfg``を実行します。
====

チャンネル同期プロセスをリアルタイムでモニタします。そのためには、ディレクトリ[path]``/var/log/rhn/reposync``にあるチャンネルログファイルを表示します。

----
tail -f /var/log/rhn/reposync/<CHANNEL_NAME>.log
----

チャンネル同期プロセスが完了したら、クライアントの登録に進むことができます。 詳細手順については、xref:client-configuration:registration-overview.adoc[]を参照してください。
