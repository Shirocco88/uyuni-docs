[[install-hardware-requirements]]
= ハードウェア要件

ifeval::[{suma-content} == true]
以下の表は、{x86_64}および{ppc64le}アーキテクチャの{productname}サーバおよびプロキシのハードウェアとソフトウェアの要件を説明しています。
endif::[]

ifeval::[{uyuni-content} == true]
以下の表は、{x86_64}アーキテクチャの{productname}サーバおよびプロキシのハードウェアとソフトウェアの要件を説明しています。
endif::[]

ifeval::[{suma-content} == true]
{ibmz}ハードウェアの要件については、xref:installation:install-ibmz.adoc[]を参照してください。
endif::[]

{productname} {smr}ハードウェアの要件については、xref:retail:retail-requirements.adoc[]を参照してください。



[[server-hardware-requirements]]
== サーバハードウェアの要件

{productname}サーバはパッケージを[path]``/var/spacewalk/``ディレクトリに保存します。 このディレクトリのディスク容量がなくなるとリポジトリの同期に失敗します。 ミラーリングするクライアントおよびリポジトリに基づいて、[path]``/var/spacewalk/``ディレクトリが必要とする容量を推測できます。



[cols="1,1,1", options="header"]
.{x86_64}アーキテクチャのサーバハードウェア要件
|===

| ハードウェア
|詳細
 | 推奨
 
 | CPU
 | -
 | 専用64ビットCPUコア数は4つ以上
 
 | RAM
 | テストサーバ
 | 8{nbsp}GB以上
 
 |
 | ベースインストール
 | 16{nbsp}GB以上
 
 |
 | 運用サーバ
 | 32{nbsp}GB以上
 
 | ディスク容量
 | [path]``/`` (ルートディレクトリ)
 | 24{nbsp}GB以上
 
 |
 | [path]``/var/lib/pgsql``
 | 50{nbsp}GB以上
 
 |
 | [path]``/var/spacewalk``
 | 各{suse}製品では50{nbsp}GB以上、各Red Hat製品では360{nbsp}GB
 
 |
 | [path]``/var/cache``
 | 10{nbsp}GB以上。
各{suse}製品にはさらに100{nbsp}MBを追加し、個々のRed Hatまたはその他の製品ではさらに1{nbsp}GBを追加します。
サーバがISS Masterの場合、容量を2倍にしてください。
 
 |
 | スワップ容量
 | 3{nbsp}GB

|===


サーバ間同期(ISS)の詳細については、xref:administration:iss.adoc[]を参照してください。



ifeval::[{suma-content} == true]
[cols="1,1,1", options="header"]
.IBM POWER8またはPOWER9アーキテクチャのサーバハードウェア要件
|===

| ハードウェア
|詳細
 | 推奨
 
 | CPU
 |
 | 専用コア数は4つ以上
 
 | RAM
 | テストサーバ
 | 8{nbsp}GB以上
 
 |
 | ベースインストール
 | 16{nbsp}GB以上
 
 |
 | 運用サーバ
 | 32{nbsp}GB以上
 
 | ディスク容量
 | [path]``/`` (ルートディレクトリ)
 | 100{nbsp}GB以上
 
 |
 | [path]``/var/lib/pgsql``
 | 50{nbsp}GB以上
 
 |
 | [path]``/var/spacewalk``
 | 各SUSE製品では50{nbsp}GB以上、各Red Hat製品では360{nbsp}GB
 
 |
 | [path]``/var/cache``
 | 10{nbsp}GB以上。
各{suse}製品にはさらに100{nbsp}MBを追加し、個々のRed Hatまたはその他の製品ではさらに1{nbsp}GBを追加します。
サーバがISS Masterの場合、容量を2倍にしてください。
 
 |
 | スワップ容量
 | 3{nbsp}GB

|===



endif::[]




== プロキシハードウェア要件

[cols="1,1,1", options="header"]
.プロキシハードウェア要件
|===

| ハードウェア
|詳細
 | 推奨
 
 | CPU
 |
 | 専用64ビットCPUコア数は2つ以上
 
 | RAM
 | テストサーバ
 | 2{nbsp}GB以上
 
 |
 | 運用サーバ
 | 8{nbsp}GB以上
 
 | ディスク容量
 | [path]``/`` (ルートディレクトリ)
 | 24{nbsp}GB以上
 
 |
 | [path]``/srv``
 | 100{nbsp}GB以上
 
 |
 | [path]``/var/cache`` (Squid)
 | 100{nbsp}GB以上

|===


{productname}プロキシは、[path]``/var/cache/``ディレクトリにパッケージをキャッシュします。 [path]``/var/cache/``の容量が不足している場合、プロキシは、古くなった、使用されていないパッケージを削除し、新しいパッケージに置き換えます。

この動作の結果は以下のとおりです。

* プロキシ上の[path]``/var/cache/``ディレクトリの容量を大きくすると、このディレクトリと{productname}サーバ間のトラフィックが少なくなります。
* プロキシ上の[path]``/var/cache/``ディレクトリを{productname}サーバ上の[path]``/var/spacewalk/``と同じサイズにすることで、最初に同期した後のトラフィック量の増大が防止されます。
* [path]``/var/cache/``ディレクトリは、{productname}サーバ上ではプロキシと比べて小さくできます。
    サイズの推測のガイドについては、<<server-hardware-requirements>セクションを参照してください。



== ストレージデバイスとパーミッション

リポジトリと{productname}のデータベースは個別のストレージデバイスに保存することをお勧めします。 こうするとデータの損失が防止されます。 YaST {productname}の設定プロシージャを実行する前にストレージデバイスを設定する必要があります。

{productname}では、3つの異なるボリュームが必要です。

* データベースボリューム: [path]``/var/lib/pgsql``
* チャンネルボリューム: [path]``/var/spacewalk``
* キャッシュ: [path]``/var/cache``

すべてのボリュームで、ファイルシステムの種類にはXFSを使用することをお勧めします。 また、オンプレミスインストールでは、論理ボリューム管理(LVM)を使用してディスクを管理することを検討してください。 リポジトリストレージのディスクのサイズは、{productname}で管理するディストリビューションおよびチャンネルの数によって決まります。 必要サイズを推測するガイドについては、このセクションの表を参照してください。

{productname}サーバで、次のコマンドを使用して、利用できるすべてのストレージデバイスを検索します。

----
hwinfo --disk | grep -E "デバイスファイル:"
----

[command]``lsblk``コマンドを使用して、各デバイスの名前とサイズを表示します。

[command]``suma-storage``コマンドにデバイス名を付けて、データベースおよびリポジトリの場所として外部デバイスを設定します。

----
suma-storage <channel_devicename> [<database_devicename>]
----

外部ストレージボリュームは、[path]``/manager_storage``および[path]``/pgsql_storage``にマウントされているXFSパーティションとして設定されます。

チャンネルデータとデータベースの両方に同じストレージデバイスを使用できます。 これはお勧めしません。その理由は、チャンネルリポジトリが大きくなると、ストレージがいっぱいになり、データベースの一貫性が損なわれるリスクが生じるためです。 別々のストレージデバイスを使用すると、パフォーマンスが向上する場合もあります。 1つのストレージデバイスを使用する場合、1つのデバイス名パラメータを指定して[command]``suma-storage``を実行します。

プロキシをインストールしている場合、[command]``suma-storage``コマンドはデバイス名パラメータを1つだけ取り、外部ストレージの場所をSquidキャッシュとして設定します。

{productname}サーバおよびプロキシのディスクパーティションを作成する場合、パーミッションを正しく設定してください。

[path]``/var/lib/pgsql``の場合:

* オーナー: 読み取り、書き込み、実行
* グループ: 読み取り、実行
* ユーザ: なし

[path]``/var/spacewalk``の場合:

* オーナー: 読み取り、書き込み、実行
* グループ: 読み取り、書き込み、実行
* ユーザ: 読み取り、実行

次のコマンドでパーミッションを確認してください。

----
ls -l /var/lib/pgsql /var/spacewalk
----

出力は次のようになります。

----
drwxr-x--- 1 postgres postgres /var/lib/pgsql
drwxrwxr-x 1 wwwrun   www      /var/spacewalk
----

必要に応じて、次のコマンドでパーミッションを変更します。

----
chmod 750 /var/lib/pgsql
chmod 775 /var/spacewalk
----

オーナーでは次のコマンドを使用します。

----
chown postgres:postgres /var/lib/pgsql
chown wwwrun:www /var/spacewalk
----
