[[server-y-yast]]
= サーバ - {yast}を使用したマイナーバージョンのアップグレード

{yast}を使用してアップグレードを実行するには、オンライン移行ツールを使用します。

[NOTE]
====
{yast}でオンライン移行ツールを使用できない場合、[package]``yast2-migration``パッケージおよび必要なすべてのパッケージをインストールします。 インストール後、{yast}を再起動し、ツールを{yast}で使用できることを確認してください。
====


[NOTE]
====
{productname} 4.0から4.2にアップグレードする場合は、未発行のパッケージがないことを確認してください。 未発行のパッケージを確認するには、menu:パッチ[パッチの管理 > Unpublished（未発行）]に移動します。 アップグレードする前に、未発行のパッケージを発行または削除する必要があります。
====



.プロシージャ: {yast}を使用したアップグレード

. コマンドプロンプトからrootとしてspacewalkサービスが実行されていないことを確認します。
+
----
spacewalk-service stop
----
+
. {yast}オンライン移行ツールを起動します。
+
----
yast2 migration
----
+
古い更新がある場合、{yast}は、まずその更新のインストールを求める通知をします。 移行を実行する前に、すべてのパッケージ更新をインストールする必要があります。 詳細については、xref:upgrade:server-z.adoc[]を参照してください。
+
{yast}は、可能な移行ターゲットと詳細を表示します。
. 適切なターゲットを選択し、プロンプトに従って移行を実行します。
. サーバを再起動します。
. 再起動するとき、{productname} spacewalkサービスは、PostgreSQLデータベースのバージョン{nbsp}13への移行が完了するまで実行されません。
. テキストコンソールにrootとしてログインします。 4.1から4.2にアップグレードする場合は、データベース移行スクリプトを実行します。
+
----
/usr/lib/susemanager/bin/pg-migrate-12-to-13.sh
----
. If you are upgrading from 4.0 to 4.2, run the database migration script:
+
----
/usr/lib/susemanager/bin/pg-migrate-10-to-13.sh
----
. spacewalkサービスが実行されていることを確認します。
+
----
spacewalk-service start
----
+
[NOTE]
====
[command]``spacewalk-schema-upgrade``は不要になりました。 これは、[command]``spacewalk-service start``の実行中に自動的に実行されます。
====


アップグレード中、{yast}は、推奨パッケージをすべてインストールします。 そのため、システムのインストールサイズが大幅に増加する可能性があります。 必須のパッケージのみをインストールするには、[path]``/etc/zypp/zypp.conf``設定ファイルを開き、次の変数を設定します。

----
solver.onlyRequires = true
installRecommends = false
----

今後のすべてのパッケージ操作の動作が変更されます。
