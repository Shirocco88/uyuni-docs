[[server-setup]]
= Uyuni Server 设置

本节介绍如何使用以下过程设置 {productname} Server：

* 使用 {yast} 启动 {productname} 安装程序
* 使用 {productname} {webui} 创建主管理帐户
* 为基础结构命名并添加登录身份凭证
* 从 {scc} 同步 {sle} 产品频道



[[server-setup-yast]]
== 使用 {yast} 安装 {productname}}

本部分将指导您完成 {productname} 安装过程。

.过程：{productname} 安装
. 登录到 {productname} Server 并启动 {yast}。

. 在 {yast} 中，导航到menu:网络服务[Uyuni 安装程序]开始安装。

. 在简介屏幕中选择 menu:Uyuni 安装程序[从头开始安装 Uyuni]，然后单击 btn:[下一步] 继续。

. 输入电子邮件地址以接收状态通知，然后单击 btn:[下一步] 继续。
    {productname} 有时可能会发送大量的通知电子邮件。如果需要，安装后您可以在 {webui} 中禁用电子邮件通知。

. 输入您的证书信息和口令。
    口令长度必须至少为七个字符，不能包含空格、单引号或双引号（``'`` 或 ``"``）、感叹号 (``!``) 或美元符号 (``$``)。始终将口令储存在安全的位置。
+

[IMPORTANT]
====
必须具有证书口令才能设置 {productname} Proxy。
====

. 单击 btn:[下一步] 继续。
+


. 在 menu:Uyuni 安装程序[数据库设置]屏幕中输入数据库用户和口令，然后单击 btn:[下一步] 继续。
    口令长度必须至少为七个字符，不能包含空格、单引号或双引号（``'`` 或 ``"``）、感叹号 (``!``) 或美元符号 (``$``)。始终将口令储存在安全的位置。
+


. 单击 btn:[下一步] 继续。

. 出现提示时，单击 btn:[是] 以运行安装程序。

. 安装完成后，单击 btn:[下一步] 继续。
    您将看到 {productname} {webui} 的地址。

. 单击 btn:[完成] 以完成 {productname} 安装。



== 创建主管理帐户

本节介绍如何创建组织的 {productname} 主管理帐户。

[WARNING]
====
主管理帐户在 {productname} 中拥有最高的权威。请确保此帐户的访问信息安全。

我们建议为组织和组创建较低级别的管理帐户。不要共享主管理帐户的访问权限细节。
====


.过程：设置主管理帐户

. 在网页浏览器中输入 {productname} {webui} 的地址。
    完成安装后已提供此地址。有关详细信息，请参见 xref:uyuni-server-setup.adoc#server-setup-yast[]。

. 登录到 {webui}，导航到menu:创建组织[组织名称]字段，然后输入您的组织名称。

. 在menu:创建组织[所需的登录名]和menu:创建组织[所需的口令]字段中，输入您的用户名和口令。

. 填写“帐户信息”字段，包括用于接收系统通知的电子邮件地址。

. 单击 btn:[创建组织] 以完成管理帐户的创建。
+


完成 {productname} {webui} 安装后，您将转到menu:主页[概览]页。


== 可选：从 {scc} 同步产品

{scc} (SCC) 维护一系列储存库，其中包含所有受支持企业客户端系统的软件包、软件和更新。这些储存库已组织成不同的频道，其中每个频道提供特定于某个发行套件、发行版和体系结构的软件。与 SCC 同步后，客户端可以接收更新，可组织成不同的组并指派到特定的产品软件频道。

本节介绍如何通过 {webui} 来与 SCC 同步，以及如何添加第一个客户端频道。

[NOTE]
====
对于 Uyuni 而言，从 {scc} 同步产品是可选操作。
====

在与 SCC 同步软件储存库之前，需在 {productname} 中输入组织身份凭证。您可以使用组织身份凭证访问 {suse} 产品下载内容。可以在 https://scc.suse.com/organizations 中找到您的组织身份凭证。

在 {productname} {webui} 中输入您的组织身份凭证：


[[proc-admin-organization-credentials]]
.过程：输入组织身份凭证
. 在 {susemgr} {webui} 中，导航到menu:主菜单[管理 > 安装向导]。
. 在[guimenu]``安装向导``页中，导航到 btn:[组织身份凭证] 选项卡。
. 单击 btn:[添加新身份凭证]。
. 输入用户名和口令，然后单击 btn:[保存]。

确认身份凭证后，会显示一个打勾图标。成功输入新的身份凭证后，即可同步到 {scc}。


[[proc-quickstart-first-channel-sync]]
.过程：与 {scc} 同步
. 在 {productname} {webui} 中，导航到menu:管理[安装向导]。

. 在[guimenu]``安装向导``页中，选择 btn:[SUSE 产品] 选项卡。
    等待片刻以填充产品列表。如果您以前在 {scc} 中注册过产品，则表格中会填充产品列表。此表格列出了体系结构、频道和状态信息。有关详细信息，请参见 xref:reference:admin/setup-wizard.adoc[向导]。
+

image::admin_suse_products.png[scaledwidth=80%]

. 如果您的 {sle} 客户端基于 [systemitem]``x86_64`` 体系结构，请向下滚动页面，并选中此频道对应的复选框。
+

* 选中每个频道左侧的复选框将相应频道添加到 {productname}。
    单击说明左侧的箭头符号可以展开产品并列出可用的模块。
* 单击 btn:[添加产品] 开始产品同步。

添加频道后，{productname} 将安排该频道的同步。这可能需要较长时间，因为 {productname} 会将频道软件源从 {scc} 中的 {suse} 储存库复制到您服务器的本地 [path]``/var/spacewalk/`` 目录。


[NOTE]
====
在某些环境中，内核提供的透明巨页可能会明显减慢 PostgreSQL 工作负载的速度。

要禁用透明巨页，请将 [parameter]``transparent_hugepage`` 内核参数设置为 ``never``。还需要打开 [path]``/etc/default/grub`` 文件，然后添加或编辑 [option]``GRUB_CMDLINE_LINUX_DEFAULT`` 行。例如：

----
GRUB_CMDLINE_LINUX_DEFAULT="resume=/dev/sda1 splash=silent quiet showopts elevator=noop transparent_hugepage=never"
----

要写入新配置，请运行 [command]``grub2-mkconfig -o /boot/grub2/grub.cfg``。
====

通过查看 [path]``/var/log/rhn/reposync`` 目录中的频道日志文件来实时监视频道同步过程：

----
tail -f /var/log/rhn/reposync/<CHANNEL_NAME>.log
----

频道同步过程完成后，您可以继续进行客户端注册。有关详细说明，请参见 xref:client-configuration:registration-overview.adoc[]。
