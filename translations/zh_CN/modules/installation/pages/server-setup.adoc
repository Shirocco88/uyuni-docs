[[server-setup]]
= SUSE Manager Server 设置

本节介绍如何使用以下过程设置 {productname} Server：

* 使用 YaST 启动 {productname} 设置
* 使用 {productname} {webui} 创建主管理帐户
* 为基础结构命名并添加登录身份凭证
* 从 {scc} 同步 {sle} 产品频道

[WARNING]
====
{productname} 属于 {sle} 产品系列，因此与 {sles} 随附的软件兼容。

{productname} 是一个复杂的系统，因此不允许安装第三方软件。仅当您不交换基本库（例如 SSL）、加密软件和类似工具时，才允许安装第三方供应商提供的监视软件。在提供产品支持的过程中，SUSE 有权要求去除任何第三方软件（以及关联的配置更改），然后在干净的系统上重现问题。
====


[IMPORTANT]
====
请不要将 {productname} 服务器注册到其自身。必须单独管理 {productname} 服务器，或者使用另一个独立的 {productname} 服务器来管理它。有关使用多个服务器的详细信息，请参见 xref:large-deployments:multi-server.adoc[]。
====



== 使用 YaST 安装 {productname}

本节指导您使用 {yast} 来完成 {productname} 安装。



.过程：{productname} 安装
. 在 {productname} Server 上的命令行中，使用 [command]``yast2 susemanager_setup`` 命令开始安装。
. 在简介屏幕中选择 menu:SUSE Manager 安装程序[从头开始安装 SUSE Manager]，然后单击 btn:[下一步] 继续。
. 输入电子邮件地址以接收状态通知，然后单击 btn:[下一步] 继续。
    {productname} 有时可能会发送大量通知电子邮件。如果需要，您可以在安装后在 {webui} 中禁用电子邮件通知。有关禁用电子邮件通知的详细信息，请参见 xref:reference:users/user-details.adoc[]。
. 输入您的证书信息和口令。
    如果您打算使用自定义 SSL 证书，需要首先进行此项设置。有关 SSL 证书的详细信息，请参见 xref:administration:ssl-certs.adoc[]。
+
image::quickstart-mgr-setup4-ncurses.png[scaledwidth=80%]
. 单击 btn:[下一步] 继续。
. 在 menu:SUSE Manager 安装程序[数据库设置]屏幕中输入数据库用户和口令，然后单击 btn:[下一步] 继续。
+
image::quickstart-mgr-setup5-ncurses.png[scaledwidth=80%]
. 单击 btn:[下一步] 继续。
. 出现提示时，单击 btn:[是] 以运行安装程序，然后等待安装完成。
. 单击 btn:[下一步] 继续。
    记下 {productname} {webui} 的地址。
. 单击 btn:[完成] 以完成 {productname} 安装。

[IMPORTANT]
====
创建证书口令时，请确保口令长度至少为七个字符。口令不能包含空格、单引号或双引号（``'`` 或 ``"``）、感叹号 (``!``) 或美元符号 (``$``)。始终将口令储存在安全的位置。没有此口令将无法设置 {productname} 代理。
====


== 创建主管理帐户

本节指导您创建组织的 {productname} 主管理帐户。

[WARNING]
====
主管理帐户是 {productname} 中 _权威最高的帐户_，因此应将帐户访问信息储存在安全的位置。

出于安全考虑，建议由主管理员创建 _较低级别的管理帐户_，旨在用于对组织和各个组进行管理。
====


.过程：设置主管理帐户
. 在浏览器中，输入完成安装后提供的地址。
    使用此地址打开 {productname} {webui}。

. 在 {webui} 中，导航到menu:创建组织[组织名称]字段并输入您的组织名称。

. 在menu:创建组织[所需的登录名]和menu:创建组织[所需的口令]字段中，输入您的用户名和口令。

. 填写“帐户信息”字段，包括用于接收系统通知的电子邮件地址。

. 单击 btn:[创建组织] 以完成管理帐户的创建。
+

image::quickstart-mgr-setup-admin1.png[scaledwidth=80%]

此时会出现 {productname} menu:主页[概览]页。


== 从 {scc} 同步产品

{scc} (SCC) 维护一系列储存库，其中包含所有受支持企业客户端系统的软件包、软件和更新。这些储存库已组织成不同的频道，其中每个频道提供特定于某个发行套件、发行版和体系结构的软件。与 SCC 同步后，客户端可以接收更新，可组织成不同的组并指派到特定的产品软件频道。

本节介绍如何通过 {webui} 来与 SCC 同步，以及如何添加第一个客户端频道。

在与 SCC 同步软件储存库之前，需在 {susemgr} 中输入组织身份凭证。在以前的版本中，使用的是所谓的镜像身份凭证。您可以使用组织身份凭证访问 SUSE 产品下载内容。可以在 https://scc.suse.com/organizations 中找到您的组织身份凭证。

在 {susemgr} {webui} 中输入您的组织身份凭证：


[[proc-admin-organization-credentials]]
.过程：输入组织身份凭证
. 在 {susemgr} {webui} 中，选择menu:管理[安装向导]。
. 在[guimenu]``安装向导``页中，选择 btn:[组织身份凭证] 选项卡。
. 单击 btn:[添加新身份凭证]。
. 在对话框中，输入[guimenu]``用户名``和[guimenu]``口令``，然后单击 btn:[保存] 以确认。

在系统以打勾图标的形式确认身份凭证后，请继续执行 <<proc-quickstart-first-channel-sync>>。


[[proc-quickstart-first-channel-sync]]
.过程：与 {scc} 同步
. 在 {webui} 中，导航到menu:管理[安装向导]。

. 在[guimenu]``安装向导``页中，选择 btn:[SUSE 产品] 选项卡。
    如果您以前在 {scc} 中注册过产品，则表格中会填充产品列表。此操作可能需要几分钟时间。您可在右侧的``从 SUSE Customer Center 刷新产品目录``部分监视该操作的进度。该产品表格会列出体系结构、频道和状态信息。有关详细信息，请参见 xref:reference:admin/setup-wizard.adoc[向导]。
+

image::admin_suse_products.png[scaledwidth=80%]

. 使用``按产品说明过滤``和``按体系结构过滤``来过滤显示的产品列表。
    如果您的 {sle} 客户端基于 [systemitem]``x86_64`` 体系结构，请向下滚动页面，并选中此频道对应的复选框。
+

* 选中每个频道左侧的复选框将相应频道添加到 {productname}。
    单击说明左侧的箭头符号可以展开产品并列出可用的模块。
* 单击 btn:[添加产品] 开始产品同步。

添加频道后，{productname} 将安排该频道的同步。这可能需要较长时间，因为 {productname} 会将频道软件源从 {scc} 中的 {suse} 储存库复制到您服务器的本地 [path]``/var/spacewalk/`` 目录。


[TIP]
.PostgreSQL 和透明巨页
====
在某些环境中，内核提供的_透明巨页_可能会明显减慢 PostgreSQL 工作负载的速度。

要禁用_透明巨页_，请将 [option]``transparent_hugepage`` 内核参数设置为 [option]``never``。必须在 [path]``/etc/default/grub`` 中更改此设置，并将其添加到 [option]``GRUB_CMDLINE_LINUX_DEFAULT`` 行，例如：

----
GRUB_CMDLINE_LINUX_DEFAULT="resume=/dev/sda1 splash=silent quiet showopts elevator=noop transparent_hugepage=never"
----

要写入新配置，请运行 [command]``grub2-mkconfig -o /boot/grub2/grub.cfg``。
====

通过查看 [path]``/var/log/rhn/reposync`` 目录中的频道日志文件来实时监视频道同步过程：

----
tail -f /var/log/rhn/reposync/<CHANNEL_NAME>.log
----

频道同步过程完成后，您可以继续进行客户端注册。有关详细说明，请参见 xref:client-configuration:registration-overview.adoc[]。
