[[ports]]
= 网络端口

本节提供了 {productname} 中各种通讯使用的端口的综合列表。

您不需要打开所有这些端口。某些端口只有在您使用需要这些端口的服务时才需打开。

下图显示了 {productname} 中使用的主要端口：

image::ports_diagram.png[]



== 外部入站服务器端口

必须打开外部入站端口，以在 {productname} Server 上配置防火墙用于防范未经授权访问服务器。

打开这些端口将允许外部网络流量访问 {productname} Server。


[cols="1,1,1,1", options="header"]
.{productname} Server 的外部端口要求
|===
| 端口号 | 协议 | 使用方 | 备注
| 22          |          |         | 采用 ssh-push 和 ssh-push-tunnel 联系方法时需要此端口。
| 67          | TCP/UDP  | DHCP    | 仅当客户端向服务器请求 IP 地址时才需要此端口。
| 69          | TCP/UDP  | TFTP    | 将服务器用作 PXE 服务器进行自动化客户端安装时需要此端口。
| 80          | TCP      | HTTP    | 某些引导储存库和自动化安装需要临时使用此端口。
端口 80 不用于为 {webui} 传递数据。
| 443         | TCP      | HTTPS   | {webui}、客户端和代理请求。
| 4505        |  TCP     | salt    | 接受来自客户端的通讯请求时需要此端口。
客户端启动连接，并保持打开状态以接收 Salt 主控端发出的命令。
| 4506        | TCP      | salt    | 接受来自客户端的通讯请求时需要此端口。
客户端启动连接，并保持打开状态以向 Salt 主控端报告结果。
| 5222        | TCP      | osad    | 将 OSAD 操作推送到客户端时需要此端口。
| 5269        | TCP      | jabberd | 向代理以及从代理推送操作时需要此端口。
| 25151       | TCP      | Cobbler |
|===



== 外部出站服务器端口

必须打开外部出站端口，以在 {productname} Server 上配置防火墙用于限制服务器可访问的内容。

打开这些端口将允许来自 {productname} Server 的网络流量与外部服务通讯。

[cols="1,1,1,1", options="header"]
.{productname} Server 的外部端口要求
|===
| 端口号 | 协议 | 使用方 | 备注
| 80          | TCP | HTTP       | {scc} 需要此端口。
端口 80 不用于为 {webui} 传递数据。
| 443         | TCP | HTTPS      | {scc} 需要此端口。
| 5269        | TCP | jabberd    | 向代理以及从代理推送操作时需要此端口。
| 25151       | TCP | Cobbler    |
|===



== 内部服务器端口

内部端口由 {productname} Server 在内部使用。只能从 ``localhost`` 访问内部端口。

大多数情况下无需调整这些端口。

[cols="1,1", options="header"]
.{productname} Server 的内部端口要求
|===
| 端口号 | 备注
| 2828        | Satellite-search API，由 Tomcat 和 Taskomatic 中的 RHN 应用程序使用。
| 2829        | Taskomatic API，由 Tomcat 中的 RHN 应用程序使用。
| 8005        | Tomcat 关机端口。
| 8009        | Tomcat 到 Apache HTTPD (AJP)。
| 8080        | Tomcat 到 Apache HTTPD (HTTP)。
| 9080        | Salt-API，由 Tomcat 和 Taskomatic 中的 RHN 应用程序使用。
| 32000       | 与运行 Taskomatic 和 satellite-search 的 Java 虚拟机 (JVM) 建立 TCP 连接时使用的端口。
|===


32768 和更高的端口用作临时端口。这些端口往往用于接收 TCP 连接。收到 TCP 连接请求后，发送方将选择其中一个临时端口号来与目标端口进行匹配。可使用以下命令来确定哪些端口是临时端口：

----
cat /proc/sys/net/ipv4/ip_local_port_range
----



== 外部入站代理端口

必须打开外部入站端口，以在 {productname} Proxy 上配置防火墙用于防范未经授权访问代理。

打开这些端口将允许外部网络流量访问 {productname} Proxy。

[cols="1,1,1,1", options="header"]
.{productname} Proxy 的外部端口要求
|===
| 端口号 | 协议 | 使用方 | 备注
| 22          |          |         | ssh-push 和 ssh-push-tunnel 联系方法需要此端口。
与代理连接的客户端在服务器上启动签入，然后跳接到其他客户端。
| 67          | TCP/UDP  | DHCP    | 仅当客户端从服务器请求 IP 地址时才需要此端口。
| 69          | TCP/UDP  | TFTP    | 将服务器用作 PXE 服务器进行自动化客户端安装时需要此端口。
| 443         | TCP      | HTTPS   | {webui}、客户端和代理请求。
| 4505        | TCP      | salt    | 接受来自客户端的通讯请求时需要此端口。
客户端启动连接，并保持打开状态以接收 Salt 主控端发出的命令。
| 4506        | TCP      | salt    | 接受来自客户端的通讯请求时需要此端口。
客户端启动连接，并保持打开状态以向 Salt 主控端报告结果。
| 5222        | TCP      |         | 将 OSAD 操作推送到客户端时需要此端口。
| 5269        | TCP      |         | 与服务器来回推送操作时需要此端口。
|===



== 外部出站代理端口

必须打开外部出站端口，以在 {productname} Proxy 上配置防火墙用于限制代理可访问的内容。

打开这些端口将允许来自 {productname} Proxy 的网络流量与外部服务通讯。

[cols="1,1,1,1", options="header"]
.{productname} Proxy 的外部端口要求
|===
| 端口号 | 协议 | 使用方 | 备注
| 80          |          |         | 用于访问服务器。
| 443         | TCP      | HTTPS   | {scc} 需要此端口。
| 5269        | TCP      |         | 与服务器来回推送操作时需要此端口。
|===



== 外部客户端端口

必须打开外部客户端端口，以在 {productname} Server 及其客户端之间配置防火墙。

大多数情况下无需调整这些端口。

[cols="1,1,1,1", options="header"]
.{productname} 客户端的外部端口要求
|===
| 端口号 | 方向 | 协议 | 备注
| 22          | 入站   | SSH      | ssh-push 和 ssh-push-tunnel 联系方法需要此端口。
| 80          | 出站  |          | 用于访问服务器或代理。
| 5222        | 出站  | TCP      | 将 OSAD 操作推送到服务器或代理时需要此端口。
| 9090        | 出站  | TCP      | Prometheus 用户界面需要此端口。
| 9093        | 出站  | TCP      | Prometheus 警报管理器需要此端口。
| 9100        | 出站  | TCP      | Prometheus 节点导出器需要此端口。
| 9117        | 出站  | TCP      | Prometheus Apache 导出器需要此端口。
| 9187        | 出站  | TCP      | Prometheus PostgreSQL 需要此端口。
|===



== 所需的 URL

{productname} 必须能够访问某些 URL 才能注册客户端和执行更新。大多数情况下，允许访问以下 URL 便已足够：

* scc.suse.com
* updates.suse.com

如果您正在使用非 {suse} 客户端，则还可能需要允许访问为这些操作系统提供特定软件包的其他服务器。例如，如果您使用的是 {ubuntu} 客户端，则需要能够访问 {ubuntu} 服务器。

有关对非 {suse} 客户端的防火墙访问进行查错的详细信息，请参见 xref:administration:tshoot-firewalls.adoc[]。
