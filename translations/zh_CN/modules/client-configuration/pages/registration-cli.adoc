[[registering-clients-cli]]
= 在命令行上注册 (Salt)


在大多数情况下，使用默认的引导方法即可正确注册 Salt 客户端。 不过，您也可以在客户端上编辑 Salt 受控端文件，并提供服务器的完全限定域名 (FQDN)，使用 Salt 手动将客户端注册到 {productname} 服务器。 此方法使用传入服务器的端口 4505 和 4506 来进行。 除了需确保这些端口处于打开状态之外，此方法无需在 {productname} 服务器上进行任何配置。

[NOTE]
====
您也可以在命令行上注册传统客户端，但这需要执行更多步骤。 本指南中将不讨论。 请使用引导脚本过程注册传统客户端。 有关详细信息，请参见 xref:registration-bootstrap.adoc[]。
====

要执行此过程，您需要在注册前于 Salt 客户端上安装 [package]``salt-minion`` 软件包。 对于基于 SLE 12 的客户端，您还需要激活[systemitem]``高级系统管理``模块。



.过程：使用 Salt 受控端配置文件注册客户端
. 在 Salt 客户端上，打开 [literal]``minion`` 配置文件。 配置文件位于以下位置：
+
----
/etc/salt/minion
----
+
或
+
----
/etc/salt/minion.d/NAME.conf
----
. 在客户端配置文件中添加或编辑 {productname} 服务器或代理的 FQDN（作为 `master`），并添加激活密钥：
+
----
master: SERVER.EXAMPLE.COM
server_id_use_src: adler42
enable_legacy_startup_events: False
enable_fqdns_grains: False
grains:
  susemanager:
    activation_key: "<Activation_Key_Name>"
----

. 重启动 [systemitem]``salt-minion`` 服务：
+
----
systemctl restart salt-minion
----
. 在 {productname} 服务器上，接受新客户端密钥（将 [systemitem]``<client>`` 替换为您客户端的名称）：
+
----
salt-key -a '<client>'
----

有关 [path]``/etc/salt/minion`` 配置文件的详细信息，请参见 https://docs.saltstack.com/en/latest/ref/configuration/minion.html。


[WARNING]
====
要注册并使用 {centos}{nbsp}6、{oracle}{nbsp}6、{rhel}{nbsp}6 或 {sleses}{nbsp}6 客户端，需要配置 {productname} 服务器以支持较旧类型的 SSL 加密。 有关如何解决此错误的详细信息，请参见 xref:client- configuration:tshoot-clients.adoc[] 中的``注册较旧的客户端``。
====



