[[vhm-azure]]
= VHM 및 Azure

You can use a virtual host manager (VHM) to gather instances from Microsoft Azure.

VHM을 통해 {productname}는 가상 머신에 대한 정보를 획득하고 보고할 수 있습니다. VHM에 대한 자세한 내용은 xref:client-configuration:vhm.adoc[]을 참조하십시오.



== Azure VHM 생성


가상 호스트 관리자(VHM)는 {productname} 서버에서 실행됩니다.

{productname} 서버에 [systemitem]``virtual-host-gatherer-libcloud`` 패키지를 설치했는지 확인하십시오.


.절차: Azure VHM 생성

. {productname} {webui}에서 menu:시스템[가상 호스트 관리자]로 이동합니다.
. btn:[생성]을 클릭하고 드롭다운 메뉴에서 [guimenu]``Azure``를 선택합니다.
. [guimenu]``Azure 가상 호스트 관리자 추가`` 섹션에서 다음과 같은 파라미터를 사용합니다.
* [guimenu]``레이블`` 필드에 VHM의 사용자 정의 이름을 입력합니다.
* [guimenu]``구독 ID`` 필드에서 Azure가 제공하는 구독 ID를 입력합니다.
* [guimenu]``응용 프로그램 ID`` 필드에 Azure가 제공하는 응용 프로그램 ID를 입력합니다.
* [guimenu]``테넌트 ID`` 필드에서 Azure가 제공하는 테넌트 ID를 입력합니다.
* [guimenu]``비밀 키`` 필드에 Azure 인스턴스에 연결된 비밀 키를 입력합니다.
* [guimenu]``영역`` 필드에 VM이 있는 영역을 입력합니다.
    이 키는 작업과 일치하는 등록을 위해 필요합니다.
. btn:[생성]을 클릭하여 변경 사항을 저장하고 VHM을 생성합니다.
. [guimenu]``가상 호스트 관리자`` 페이지에서 새 VHM을 선택합니다.
. [guimenu]``등록 정보`` 페이지에서 btn:[데이터 새로 고침]을 클릭하여 새 VHM을 목록에 포함합니다.

어떤 객체 및 리소스가 목록에 포함되었는지 확인하려면 menu:시스템[시스템 목록 > 가상 시스템]으로 이동하십시오.



== 권한 할당

사용자가 생성하는 VHM은 Azure VM에 액세스하려면 올바른 권한이 할당되어 있어야 합니다.

Azure 계정에 구독 관리자로 로그인하여 Azure 사용자 계정 및 응용 프로그램이 올바른 그룹에 있는지 확인하십시오. 응용 프로그램이 속한 그룹에 따라 응용 프로그램의 역할이 결정되고, 이에 따라 권한도 결정됩니다.

권한이 올바르게 설정되지 않으면 [command]``virtual-host-gatherer``를 실행할 때 다음과 같은 오류를 수신할 수 있습니다.

----
일반 오류: [AuthorizationFailed] 객체 ID가 ‘object_ID’인 'client_name' 클라이언트에 '/subscriptions/not-very-secret-subscription-id' 범위에 걸쳐 ‘Microsoft.Compute/virtualMachines/read’ 작업을 수행할 권한이 없거나 이 범위가 잘못되었습니다. 액세스가 최근에 허용되었다면 인증서를 새로 고침하시기 바랍니다.
----

인증서가 올바른지 확인하려면 다음과 같이 {productname} 서버의 프롬프트에서 다음 명령을 실행하십시오.

----
virtual-host-gatherer -i input_azure.json -o out_azure.json -vvv
----

[path]``input_azure.json`` 파일은 다음과 같은 정보를 포함해야 합니다.

----
[
    {
         \id\: \azure_vhm\,
         \module\: \Azure\,
         \subscription_id\: \subscription-id\,
         \application_id\: \application-id\,
         	enant_id\: 	enant-id\,
         \secret_key\: \secret-key\,
         \zone\: \zone\n     }
 ]
----



== Azure UUID

Azure 공용 클라우드에서 실행되는 인스턴스는 다음과 같이 이 UUID를 {productname} 서버에 보고합니다.

----
13f56399-bd52-4150-9748-7190aae1ff21
----
