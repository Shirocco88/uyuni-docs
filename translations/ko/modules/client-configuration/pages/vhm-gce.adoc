[[vhm-hce]]
= VHM 및 Google Compute Engine

You can use a virtual host manager (VHM) to gather instances from Google Compute Engine (GCE).

VHM을 통해 {productname}는 가상 머신에 대한 정보를 획득하고 보고할 수 있습니다. VHM에 대한 자세한 내용은 xref:client-configuration:vhm.adoc[]을 참조하십시오.



== GCE VHM 생성


가상 호스트 관리자(VHM)는 {productname} 서버에서 실행됩니다.

VHM을 실행하려면 {productname} 서버가 포트 443을 열어 클라이언트에 액세스해야 합니다.

{productname} 서버에 [systemitem]``virtual-host-gatherer-libcloud`` 패키지를 설치했는지 확인하십시오.

시작하기 전에 GCE 패널에 로그인하여 인증서 파일을 다운로드합니다. 이 파일을 {productname} 서버에 로컬로 저장하고 경로를 적어 둡니다.



.절차: GCE VHM 생성

. {productname} {webui}에서 menu:시스템[가상 호스트 관리자]로 이동합니다.
. btn:[생성]을 클릭하고 드롭다운 메뉴에서 [guimenu]``Google Compute Engine``을 선택합니다.
. [guimenu]``Google Compute Engine 가상 호스트 관리자 추가`` 섹션에서 다음과 같은 파라미터를 사용합니다.
* [guimenu]``레이블`` 필드에 VHM의 사용자 정의 이름을 입력합니다.
* [guimenu]``서비스 계정 전자 메일`` 필드에 Google 계정에 연결된 이메일 주소를 입력합니다.
* [guimenu]``인증서 경로`` 필드에 GCE 패널에서 다운로드한 인증서의 경로를 입력합니다.
* [guimenu]``프로젝트 ID`` 필드에 GCE 인스턴스가 사용하는 프로젝트 ID를 입력합니다.
* [guimenu]``영역`` 필드에 VM이 있는 영역을 입력합니다.
    이 키는 작업과 일치하는 등록을 위해 필요합니다.
. btn:[생성]을 클릭하여 변경 사항을 저장하고 VHM을 생성합니다.
. [guimenu]``가상 호스트 관리자`` 페이지에서 새 VHM을 선택합니다.
. [guimenu]``등록 정보`` 페이지에서 btn:[데이터 새로 고침]을 클릭하여 새 VHM을 목록에 포함합니다.

어떤 객체 및 리소스가 목록에 포함되었는지 확인하려면 menu:시스템[시스템 목록 > 가상 시스템]으로 이동하십시오.



== 권한 할당

사용자가 생성하는 VHM은 GCE VM에 액세스하려면 올바른 권한이 할당되어 있어야 합니다.

Google 클라우드 플랫폼 계정에 관리자로 로그인하여 Cloud Identity and Access Management(IAM) 도구를 사용해 서비스 계정에 적절한 역할이 있는지 확인합니다. VM이 `VM`` 역할에 할당되었는지도 확인해야 합니다.

권한이 올바르게 설정되지 않으면 [command]``virtual-host-gatherer``를 실행할 때 다음과 같은 오류를 수신할 수 있습니다.

----
ERROR: {'domain': 'global', 'reason': 'forbidden', 'message': 'projects/project-id'\}
 에  'compute.zones.list' 권한 필요 ERROR: 지정된 인증서를 사용해 Google Compute Engine 공용 클라우드에 연결할 수 없습니다.
----

인증서가 올바른지 확인하려면 다음과 같이 {productname} 서버의 프롬프트에서 다음 명령을 실행하십시오.

----
virtual-host-gatherer -i input_google.json -o out_google.json -vvv
----

[path]``input_google.json`` 파일은 다음과 같은 정보를 포함해야 합니다.

----
[
    {
         \id\: \google_vhm\,
         \module\: \GoogleCE\,
         \service_account_email\: \mail@example.com\,
         \cert_path\: \secret-key\,
         \project_id\: \project-id\,
         \zone\: \zone\n     }
 ]
----



== GCE UUID

Google 공용 클라우드에서 실행되는 인스턴스는 다음과 같이 이 UUID를 {productname} 서버에 보고합니다.

----
152986662232938449
----
